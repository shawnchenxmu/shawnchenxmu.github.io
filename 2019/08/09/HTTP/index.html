<!doctype html>



  


<html class="theme-next muse use-motion">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css">


  <meta name="keywords" content="HTTP,">








  <link rel="shortcut icon" type="image/x-icon" href="/images/icon.png?v=5.0.2">






<meta name="description" content="Overview of HTTPAn overview of HTTP HTTP is an application-layer protocol for transmitting hypermedia documents. HTTP follows a classical client-server model, with a client opening a connection to mak">
<meta name="keywords" content="HTTP">
<meta property="og:type" content="article">
<meta property="og:title" content="HTTP">
<meta property="og:url" content="http://yoursite.com/2019/08/09/HTTP/index.html">
<meta property="og:site_name" content="Shawnchen &#x2F; XMU 。">
<meta property="og:description" content="Overview of HTTPAn overview of HTTP HTTP is an application-layer protocol for transmitting hypermedia documents. HTTP follows a classical client-server model, with a client opening a connection to mak">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/2019/08/09/HTTP/1.png">
<meta property="og:image" content="http://yoursite.com/2019/08/09/HTTP/2.png">
<meta property="og:image" content="http://yoursite.com/2019/08/09/HTTP/3.png">
<meta property="og:image" content="http://yoursite.com/2019/08/09/HTTP/4.png">
<meta property="og:image" content="http://yoursite.com/2019/08/09/HTTP/5.png">
<meta property="og:image" content="http://yoursite.com/2019/08/09/HTTP/6.png">
<meta property="og:image" content="http://yoursite.com/2019/08/09/HTTP/7.png">
<meta property="og:image" content="http://yoursite.com/2019/08/09/HTTP/8.png">
<meta property="og:image" content="http://yoursite.com/2019/08/09/HTTP/9.png">
<meta property="og:image" content="http://yoursite.com/2019/08/09/HTTP/10.png">
<meta property="og:image" content="http://yoursite.com/2019/08/09/HTTP/11.png">
<meta property="og:updated_time" content="2021-02-14T12:05:31.360Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HTTP">
<meta name="twitter:description" content="Overview of HTTPAn overview of HTTP HTTP is an application-layer protocol for transmitting hypermedia documents. HTTP follows a classical client-server model, with a client opening a connection to mak">
<meta name="twitter:image" content="http://yoursite.com/2019/08/09/HTTP/1.png">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Shawnchen'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/2019/08/09/HTTP/">


  <title> HTTP | Shawnchen / XMU 。 </title>
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-122678625-1', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Shawnchen / XMU 。</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="https://shawnchenxmu.github.io/shawnchenxmu.com/" rel="section">
            
            about
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
            Timelines
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                HTTP
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2019-08-09T11:36:39+08:00" content="2019-08-09">
              2019-08-09
            </time>
          </span>

          
            <span class="post-category">
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术止熵/" itemprop="url" rel="index">
                    <span itemprop="name">技术止熵</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="Overview-of-HTTP"><a href="#Overview-of-HTTP" class="headerlink" title="Overview of HTTP"></a>Overview of HTTP</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Overview" target="_blank" rel="noopener">An overview of HTTP</a></p>
<p>HTTP is an <strong>application-layer</strong> protocol for transmitting hypermedia documents.</p>
<p>HTTP follows a classical <a href="https://en.wikipedia.org/wiki/Client%E2%80%93server_model" target="_blank" rel="noopener">client-server model</a>, with a client opening a connection to make a request, then waiting until it receives a response.</p>
<p>HTTP is a <strong>stateless protocol</strong>, meaning that the server does not keep any data (state) between two requests.</p>
<h2 id="HTTP-Cache"><a href="#HTTP-Cache" class="headerlink" title="HTTP Cache"></a>HTTP Cache</h2><p><a href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/http-caching" target="_blank" rel="noopener">HTTP 缓存 (google)</a><br><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Caching" target="_blank" rel="noopener">HTTP caching (MDN)</a></p>
<p><img src="/2019/08/09/HTTP/1.png" alt></p>
<h3 id="缓存控制"><a href="#缓存控制" class="headerlink" title="缓存控制"></a>缓存控制</h3><h4 id="Cache-control"><a href="#Cache-control" class="headerlink" title="Cache-control"></a><code>Cache-control</code></h4><p>HTTP/1.1 定义的 <code>Cache-Control</code> 头用来区分对缓存机制的支持情况， 请求头和响应头都支持这个属性。通过它提供的不同的值来定义缓存策略。</p>
<details><summary>用法</summary><br><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 禁止进行缓存</span></span><br><span class="line"><span class="comment"># 缓存中不得存储任何关于客户端请求和服务端响应的内容。</span></span><br><span class="line"><span class="comment"># 每次由客户端发起的请求都会下载完整的响应内容。</span></span><br><span class="line">Cache-Control: no-store</span><br><span class="line"></span><br><span class="line"><span class="comment"># 强制确认缓存</span></span><br><span class="line"><span class="comment"># 此方式下，每次有请求发出时，缓存会将此请求发到服务器（该请求应该会带有与本地缓存相关的验证字段）</span></span><br><span class="line"><span class="comment"># 服务器端会验证请求中所描述的缓存是否过期，若未过期（注：实际就是返回304），则缓存才使用本地缓存副本</span></span><br><span class="line">Cache-Control: no-cache</span><br><span class="line"></span><br><span class="line"><span class="comment"># 私有缓存和公共缓存</span></span><br><span class="line"><span class="comment"># "public" 指令表示该响应可以被任何中间人（比如中间代理、CDN等）缓存。</span></span><br><span class="line"><span class="comment"># 若指定了"public"，则一些通常不被中间人缓存的页面（因为默认是private）</span></span><br><span class="line"><span class="comment"># 比如 带有HTTP验证信息（帐号密码）的页面 或 某些特定状态码的页面，将会被其缓存。</span></span><br><span class="line"><span class="comment"># 而 "private" 则表示该响应是专用于某单个用户的</span></span><br><span class="line"><span class="comment"># 中间人不能缓存此响应，该响应只能应用于浏览器私有缓存中。</span></span><br><span class="line">Cache-Control: private</span><br><span class="line">Cache-Control: public</span><br><span class="line"></span><br><span class="line"><span class="comment"># 缓存过期机制</span></span><br><span class="line"><span class="comment"># 过期机制中，最重要的指令是 "max-age=&lt;seconds&gt;"</span></span><br><span class="line"><span class="comment"># 表示资源能够被缓存（保持新鲜）的最大时间。</span></span><br><span class="line"><span class="comment"># 相对Expires而言，max-age是距离请求发起的时间的秒数。</span></span><br><span class="line"><span class="comment"># 针对应用中那些不会改变的文件，通常可以手动设置一定的时长以保证缓存有效</span></span><br><span class="line"><span class="comment"># 例如图片、css、js等静态资源。</span></span><br><span class="line">Cache-Control: max-age=31536000</span><br><span class="line"></span><br><span class="line"><span class="comment"># 缓存验证确认</span></span><br><span class="line"><span class="comment"># 当使用了 "must-revalidate" 指令</span></span><br><span class="line"><span class="comment"># 那就意味着缓存在考虑使用一个陈旧的资源时，必须先验证它的状态</span></span><br><span class="line"><span class="comment"># 已过期的缓存将不被使用</span></span><br><span class="line">Cache-Control: must-revalidate</span><br></pre></td></tr></table></figure><br><br></details>

<h4 id="Pragma"><a href="#Pragma" class="headerlink" title="Pragma"></a><code>Pragma</code></h4><p><code>Pragma</code> 是 HTTP/1.0 标准中定义的一个 header 属性，请求中包含 <code>Pragma</code> 的效果跟在头信息中定义 <code>Cache-Control: no-cache</code> 相同，但是 HTTP 的响应头不支持这个属性，所以它不能拿来完全替代 HTTP/1.1 中定义的 <code>Cache-control</code> 头。通常定义 <code>Pragma</code> 以向后兼容基于 HTTP/1.0 的客户端</p>
<h3 id="新鲜度"><a href="#新鲜度" class="headerlink" title="新鲜度"></a>新鲜度</h3><details><summary>定义</summary><br><br>理论上来讲，当一个资源被缓存存储后，该资源应该可以被永久存储在缓存中。由于缓存只有有限的空间用于存储资源副本，所以缓存会定期地将一些副本删除，这个过程叫做<strong>缓存驱逐</strong>。<br><br>另一方面，当服务器上面的资源进行了更新，那么缓存中的对应资源也应该被更新，由于 HTTP 是 C/S 模式的协议，服务器更新一个资源时，不可能直接通知客户端及其缓存，所以双方必须为该资源约定一个过期时间，在该过期时间之前，该资源（缓存副本）就是新鲜的，当过了过期时间后，该资源（缓存副本）则变为陈旧的。驱逐算法用于将陈旧的资源（缓存副本）替换为新鲜的.<br><br>注意，一个陈旧的资源（缓存副本）是不会直接被清除或忽略的，当客户端发起一个请求时，缓存检索到已有一个对应的陈旧资源（缓存副本），则缓存会先将此请求附加一个 <code>If-None-Match</code> 头，然后发给目标服务器，以此来检查该资源副本是否是依然还是算新鲜的，若服务器返回了 304 (Not Modified)（该响应不会有带有实体信息），则表示此资源副本是新鲜的，这样一来，可以节省一些带宽。若服务器通过 <code>If-None-Match</code> 或 <code>If-Modified-Since</code> 判断后发现已过期，那么会带有该资源的实体内容返回。<br><br>对于含有特定头信息的请求，会去计算缓存寿命。比如 <code>Cache-control: max-age=N</code> 的头，相应的缓存的寿命就是 N。通常情况下，对于不含这个属性的请求则会去查看是否包含 <code>Expires</code> 属性，通过比较 <code>Expires</code> 的值和头里面 <code>Date</code> 属性的值来判断是否缓存还有效。如果 <code>max-age</code> 和 <code>expires</code> 属性都没有，找找头里的 <code>Last-Modified</code> 信息。如果有，缓存的寿命就等于头里面 <code>Date</code> 的值减去 <code>Last-Modified</code> 的值除以 10（注：根据 rfc2626 其实也就是乘以 10%）。<br><br>缓存失效时间计算公式如下：<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">expirationTime = responseTime + freshnessLifetime - currentAge</span><br></pre></td></tr></table></figure><br><br>上式中，<code>responseTime</code> 表示浏览器接收到此响应的那个时间点。<br><br></details>

<p><img src="/2019/08/09/HTTP/2.png" alt></p>
<h3 id="定义最佳-Cache-Control-策略"><a href="#定义最佳-Cache-Control-策略" class="headerlink" title="定义最佳 Cache-Control 策略"></a>定义最佳 Cache-Control 策略</h3><p><img src="/2019/08/09/HTTP/3.png" alt></p>
<h3 id="缓存验证"><a href="#缓存验证" class="headerlink" title="缓存验证"></a>缓存验证</h3><details><summary>缓存验证</summary><br><br>用户点击刷新按钮时会开始缓存验证。如果缓存的响应头信息里含有 <code>Cache-control: must-revalidate</code> 的定义，在浏览的过程中也会触发缓存验证。另外，在浏览器偏好设置里设置Advanced -&gt; Cache 为强制验证缓存也能达到相同的效果。<br><br>当缓存的文档过期后，需要进行缓存验证或者重新获取资源。只有在服务器返回强校验器或者弱校验器时才会进行验证。<br><br><strong>ETag</strong><br>作为缓存的一种强校验器，<code>ETag</code> 响应头是一个对用户代理不透明（UA 无需理解，只需要按规定使用即可）的值。对于像浏览器这样的 HTTP UA，不知道 <code>ETag</code> 代表什么，不能预测它的值是多少。如果资源请求的响应头里含有 <code>ETag</code>，客户端可以在后续的请求的头中带上 <code>If-None-Match</code> 头来验证缓存。<br><br><strong>Last-Modified</strong><br><code>Last-Modified</code> 响应头可以作为一种弱校验器。说它弱是因为它只能精确到一秒。如果响应头里含有这个信息，客户端可以在后续的请求中带上 <code>If-Modified-Since</code> 来验证缓存。<br><br>当向服务端发起缓存校验的请求时，服务端会返回 200 ok 表示返回正常的结果或者 304 Not Modified(不返回body)表示浏览器可以使用本地缓存文件。304的响应头也可以同时更新缓存文档的过期时间。<br><br></details>

<h3 id="带-Vary-头的响应"><a href="#带-Vary-头的响应" class="headerlink" title="带 Vary 头的响应"></a>带 Vary 头的响应</h3><details><summary>带 Vary 头的响应</summary><br><br>Vary HTTP 响应头决定了对于后续的请求头，如何判断是请求一个新的资源还是使用缓存的文件。<br><br>当缓存服务器收到一个请求，只有当前的请求和原始（缓存）的请求头跟缓存的响应头里的 Vary 都匹配，才能使用缓存的响应。<br><br><img src="/2019/08/09/HTTP/4.png" alt><br><br>使用 vary 头有利于内容服务的动态多样性。例如，使用 <code>Vary: User-Agent</code> 头，缓存服务器需要通过 UA 判断是否使用缓存的页面。如果需要区分移动端和桌面端的展示内容，利用这种方式就能避免在不同的终端展示错误的布局。另外，它可以帮助 Google 或者其他搜索引擎更好地发现页面的移动版本，并且告诉搜索引擎没有引入 Cloaking。<br><br></details>

<h2 id="HTTP-Cookies"><a href="#HTTP-Cookies" class="headerlink" title="HTTP Cookies"></a>HTTP Cookies</h2><p>HTTP Cookie 是服务器发送到用户浏览器并保存在本地的一小块数据，它会在浏览器下次向同一服务器再发起请求时被携带并发送到服务器上。通常，它用于告知服务端两个请求是否来自同一浏览器，如保持用户的登录状态。</p>
<p>Cookie 使基于无状态的 HTTP 协议记录稳定的状态信息成为了可能。</p>
<h3 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h3><p>Cookie 主要用于以下三个方面：</p>
<ol>
<li>会话状态管理（如用户登录状态、购物车、游戏分数或其它需要记录的信息）</li>
<li>个性化设置（如用户自定义设置、主题等）</li>
<li>浏览器行为跟踪（如跟踪分析用户行为等）</li>
</ol>
<h3 id="创建-Cookie"><a href="#创建-Cookie" class="headerlink" title="创建 Cookie"></a>创建 Cookie</h3><p>当服务器收到 HTTP 请求时，服务器可以在响应头里面添加一个 <code>Set-Cookie</code> 选项。浏览器收到响应后通常会保存下 Cookie，之后对该服务器每一次请求中都通过 Cookie 请求头部将 Cookie 信息发送给服务器。另外，Cookie 的过期时间、域、路径、有效期、适用站点都可以根据需要来指定。</p>
<h4 id="Set-Cookie-响应头部和-Cookie-请求头部"><a href="#Set-Cookie-响应头部和-Cookie-请求头部" class="headerlink" title="Set-Cookie 响应头部和 Cookie 请求头部"></a><code>Set-Cookie</code> 响应头部和 <code>Cookie</code> 请求头部</h4><p>一个简单的 Cookie 可能像这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: &lt;cookie名&gt;=&lt;cookie值&gt;</span><br></pre></td></tr></table></figure>
<p>服务器通过该头部告知客户端保存 Cookie 信息。</p>
<p>现在，对该服务器发起的每一次新请求，浏览器都会将之前保存的 Cookie 信息通过 Cookie 请求头部再发送给服务器。</p>
<h4 id="会话期-Cookie"><a href="#会话期-Cookie" class="headerlink" title="会话期 Cookie"></a>会话期 Cookie</h4><p>会话期 Cookie 是最简单的 Cookie：浏览器关闭之后它会被自动删除，也就是说它仅在会话期内有效。会话期 Cookie 不需要指定过期时间（Expires）或者有效期（Max-Age）。需要注意的是，有些浏览器提供了会话恢复功能，这种情况下即使关闭了浏览器，会话期 Cookie 也会被保留下来，就好像浏览器从来没有关闭一样。</p>
<h4 id="持久性-Cookie"><a href="#持久性-Cookie" class="headerlink" title="持久性 Cookie"></a>持久性 Cookie</h4><p>和关闭浏览器便失效的会话期 Cookie 不同，持久性 Cookie 可以指定一个特定的过期时间（Expires）或有效期（Max-Age）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: id=a3fWa; Expires=Wed, 21 Oct 2015 07:28:00 GMT;</span><br></pre></td></tr></table></figure>
<h4 id="Cookie-的-Secure-和-HttpOnly-标记"><a href="#Cookie-的-Secure-和-HttpOnly-标记" class="headerlink" title="Cookie 的 Secure 和 HttpOnly 标记"></a>Cookie 的 <code>Secure</code> 和 <code>HttpOnly</code> 标记</h4><p>标记为 Secure 的 Cookie 只应通过被 HTTPS 协议加密过的请求发送给服务端。</p>
<p>为避免跨域脚本 (XSS) 攻击，通过 JavaScript 的 <code>Document.cookie</code> API无法访问带有 HttpOnly 标记的 Cookie。</p>
<p>Cookie 不想被客户端 JavaScript 脚本调用，那么就应该为其设置 HttpOnly 标记。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: id=a3fWa; Expires=Wed, 21 Oct 2015 07:28:00 GMT; Secure; HttpOnly</span><br></pre></td></tr></table></figure>
<h4 id="Cookie-的作用域"><a href="#Cookie-的作用域" class="headerlink" title="Cookie 的作用域"></a>Cookie 的作用域</h4><p>Domain 和 Path 标识定义了 Cookie 的作用域：即 Cookie 应该发送给哪些 URL。</p>
<h3 id="第三方-Cookie"><a href="#第三方-Cookie" class="headerlink" title="第三方 Cookie"></a>第三方 Cookie</h3><p>每个 Cookie 都会有与之关联的域（Domain），如果 Cookie 的域和页面的域相同，那么我们称这个 Cookie 为第一方 Cookie（first-party cookie），如果 Cookie 的域和页面的域不同，则称之为第三方 Cookie（third-party cookie.）。</p>
<p>通过第三方组件发送的第三方 Cookie 主要用于广告和网络追踪。</p>
<h3 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Cookies" target="_blank" rel="noopener">HTTP cookies</a><br><a href="https://policies.google.com/technologies/cookies?hl=zh-CN" target="_blank" rel="noopener">Google 如何使用 Cookie</a><br><a href="https://policies.google.com/technologies/types?hl=zh-CN" target="_blank" rel="noopener">Google 使用的 Cookie 类型</a></p>
<h2 id="Cross-Origin-Resource-Sharing-CORS"><a href="#Cross-Origin-Resource-Sharing-CORS" class="headerlink" title="Cross-Origin Resource Sharing (CORS)"></a>Cross-Origin Resource Sharing (CORS)</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS" target="_blank" rel="noopener">Cross-Origin Resource Sharing (CORS)</a></p>
<p>跨域资源共享（ CORS ）机制允许 Web 应用服务器进行跨域访问控制，从而使跨域数据传输得以安全进行。</p>
<p><img src="/2019/08/09/HTTP/5.png" alt></p>
<h3 id="什么情况下需要-CORS-？"><a href="#什么情况下需要-CORS-？" class="headerlink" title="什么情况下需要 CORS ？"></a>什么情况下需要 CORS ？</h3><ol>
<li>由 XMLHttpRequest 或 Fetch 发起的跨域 HTTP 请求</li>
<li>Web 字体 (CSS 中通过 @font-face 使用跨域字体资源)</li>
<li>WebGL 贴图</li>
<li>使用 drawImage 将 Images/video 画面绘制到 canvas</li>
</ol>
<h3 id="基本功能"><a href="#基本功能" class="headerlink" title="基本功能"></a>基本功能</h3><p>跨域资源共享标准新增了一组 HTTP 首部字段，允许服务器声明哪些源站通过浏览器有权限访问哪些资源。另外，规范要求，对那些可能对服务器数据产生副作用的 HTTP 请求方法（特别是 GET 以外的 HTTP 请求，或者搭配某些 MIME 类型的 POST 请求），浏览器必须首先使用 OPTIONS 方法发起一个预检请求（preflight request），从而获知服务端是否允许该跨域请求。服务器确认允许之后，才发起实际的 HTTP 请求。在预检请求的返回中，服务器端也可以通知客户端，是否需要携带身份凭证（包括 Cookies 和 HTTP 认证相关数据）。</p>
<p>CORS 请求失败会产生错误，但是为了安全，在 JavaScript 代码层面是无法获知到底具体是哪里出了问题。只能查看浏览器的控制台以得知具体是哪里出现了错误。</p>
<h3 id="若干访问控制场景"><a href="#若干访问控制场景" class="headerlink" title="若干访问控制场景"></a>若干访问控制场景</h3><h4 id="简单请求"><a href="#简单请求" class="headerlink" title="简单请求"></a>简单请求</h4><p>某些请求不会触发 CORS 预检请求，这样的请求为『简单请求』。</p>
<details><summary>简单请求</summary><br><br>若请求满足所有下述条件，则该请求可视为『简单请求』：<br><br>1. 使用下列方法之一：<br>    <code>GET</code><br>    <code>HEAD</code><br>    <code>POST</code><br><br>2. Fetch 规范定义了对 CORS 安全的首部字段集合，不得人为设置该集合之外的其他首部字段。该集合为：<br>     <code>Accept</code><br>     <code>Accept-Language</code><br>     <code>Content-Language</code><br>     <code>Content-Type</code> （需要注意额外的限制）<br>     <code>DPR</code><br>     <code>Downlink</code><br>     <code>Save-Data</code><br>     <code>Viewport-Width</code><br>     <code>Width</code><br><br>3. <code>Content-Type</code> 的值仅限于下列三者之一：<br>     <code>text/plain</code><br>     <code>multipart/form-data</code><br>     <code>application/x-www-form-urlencoded</code><br><br>4. 请求中的任意 <code>XMLHttpRequestUpload</code> 对象均没有注册任何事件监听器；<code>XMLHttpRequestUpload</code> 对象可以使用 <code>XMLHttpRequest.upload</code> 属性访问。<br><br>5. 请求中没有使用 <code>ReadableStream</code> 对象。<br><br></details>

<h4 id="预检请求"><a href="#预检请求" class="headerlink" title="预检请求"></a>预检请求</h4><p>『需预检的请求』要求必须首先使用 OPTIONS 方法发起一个预检请求到服务器，以获知服务器是否允许该实际请求。『预检请求』的使用，可以避免跨域请求对服务器的用户数据产生未预期的影响。</p>
<details><summary>预检请求</summary><br><br>当请求满足下述任一条件时，即应首先发送预检请求：<br><br>1. 使用了下面任一 HTTP 方法：<br>    <code>PUT</code><br>    <code>DELETE</code><br>    <code>CONNECT</code><br>    <code>OPTIONS</code><br>    <code>TRACE</code><br>    <code>PATCH</code><br><br>2. 人为设置了对 CORS 安全的首部字段集合之外的其他首部字段。该集合为：<br>    <code>Accept</code><br>    <code>Accept-Language</code><br>    <code>Content-Language</code><br>    <code>Content-Type</code> (需要注意额外的限制)<br>    <code>DPR</code><br>    <code>Downlink</code><br>    <code>Save-Data</code><br>    <code>Viewport-Width</code><br>    <code>Width</code><br><br>3. <code>Content-Type</code> 的值不属于下列之一:<br>     <code>application/x-www-form-urlencoded</code><br>     <code>multipart/form-data</code><br>     <code>text/plain</code><br><br>4. 请求中的 <code>XMLHttpRequestUpload</code> 对象注册了任意多个事件监听器。<br><br>5. 请求中使用了 <code>ReadableStream</code> 对象。<br><br></details>

<p><img src="/2019/08/09/HTTP/6.png" alt></p>
<h4 id="附带身份凭证的请求"><a href="#附带身份凭证的请求" class="headerlink" title="附带身份凭证的请求"></a>附带身份凭证的请求</h4><p>对于跨域 XMLHttpRequest 或 Fetch 请求，浏览器不会发送身份凭证信息。如果要发送凭证信息，需要设置 XMLHttpRequest 的某个特殊标志位，将 XMLHttpRequest 的 <code>withCredentials</code> 标志设置为 <code>true</code>，从而向服务器发送 Cookies。因为这是一个简单 GET 请求，所以浏览器不会对其发起『预检请求』。但是，如果服务器端的响应中未携带 <code>Access-Control-Allow-Credentials: true</code> ，浏览器将不会把响应内容返回给请求的发送者。</p>
<h5 id="❗️注意：附带身份凭证的请求与通配符"><a href="#❗️注意：附带身份凭证的请求与通配符" class="headerlink" title="❗️注意：附带身份凭证的请求与通配符"></a>❗️注意：附带身份凭证的请求与通配符</h5><p>对于附带身份凭证的请求，服务器不得设置 <code>Access-Control-Allow-Origin</code> 的值为 <code>*</code>。</p>
<p>这是因为请求的首部中携带了 Cookie 信息，如果 <code>Access-Control-Allow-Origin</code> 的值为 <code>*</code>，请求将会失败。而将 <code>Access-Control-Allow-Origin</code> 的值设置为 <code>http://foo.example</code>，则请求将成功执行。</p>
<h3 id="HTTP-响应首部字段"><a href="#HTTP-响应首部字段" class="headerlink" title="HTTP 响应首部字段"></a>HTTP 响应首部字段</h3><h4 id="Access-Control-Allow-Origin"><a href="#Access-Control-Allow-Origin" class="headerlink" title="Access-Control-Allow-Origin"></a><code>Access-Control-Allow-Origin</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Origin: &lt;origin&gt; | *</span><br></pre></td></tr></table></figure>
<p>origin 参数的值指定了允许访问该资源的外域 URI。对于不需要携带身份凭证的请求，服务器可以指定该字段的值为通配符，表示允许来自所有域的请求。</p>
<p>如果服务端指定了具体的域名而非 <code>*</code>，那么响应首部中的 <code>Vary</code> 字段的值必须包含 <code>Origin</code>。这将告诉客户端：服务器对不同的源站返回不同的内容。</p>
<h4 id="Access-Control-Expose-Headers"><a href="#Access-Control-Expose-Headers" class="headerlink" title="Access-Control-Expose-Headers"></a><code>Access-Control-Expose-Headers</code></h4><p>在跨域访问时，XMLHttpRequest 对象的 <code>getResponseHeader()</code> 方法只能拿到一些最基本的响应头，<code>Cache-Control</code>、<code>Content-Language</code>、<code>Content-Type</code>、<code>Expires</code>、<code>Last-Modified</code>、<code>Pragma</code>，如果要访问其他头，则需要服务器设置本响应头。</p>
<p><code>Access-Control-Expose-Headers</code> 头让服务器把允许浏览器访问的头放入白名单，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Expose-Headers: X-My-Custom-Header, X-Another-Custom-Header</span><br></pre></td></tr></table></figure>
<p>这样浏览器就能够通过 <code>getResponseHeader</code> 访问 <code>X-My-Custom-Header</code> 和 <code>X-Another-Custom-Header</code> 响应头了。</p>
<h4 id="Access-Control-Max-Age"><a href="#Access-Control-Max-Age" class="headerlink" title="Access-Control-Max-Age"></a><code>Access-Control-Max-Age</code></h4><p><code>Access-Control-Max-Age</code> 头指定了 preflight 请求的结果能够被缓存多久</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Max-Age: &lt;delta-seconds&gt;</span><br></pre></td></tr></table></figure>
<h4 id="Access-Control-Allow-Credentials"><a href="#Access-Control-Allow-Credentials" class="headerlink" title="Access-Control-Allow-Credentials"></a><code>Access-Control-Allow-Credentials</code></h4><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials" target="_blank" rel="noopener">Access-Control-Allow-Credentials</a></p>
<h4 id="Access-Control-Allow-Methods"><a href="#Access-Control-Allow-Methods" class="headerlink" title="Access-Control-Allow-Methods"></a><code>Access-Control-Allow-Methods</code></h4><p><code>Access-Control-Allow-Methods</code> 首部字段用于预检请求的响应。其指明了实际请求所允许使用的 HTTP 方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Methods: &lt;method&gt;[, &lt;method&gt;]*</span><br></pre></td></tr></table></figure>
<h4 id="Access-Control-Allow-Headers"><a href="#Access-Control-Allow-Headers" class="headerlink" title="Access-Control-Allow-Headers"></a><code>Access-Control-Allow-Headers</code></h4><p><code>Access-Control-Allow-Headers</code> 首部字段用于预检请求的响应。其指明了实际请求中允许携带的首部字段。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Headers: &lt;field-name&gt;[, &lt;field-name&gt;]*</span><br></pre></td></tr></table></figure>
<h3 id="HTTP-请求首部字段"><a href="#HTTP-请求首部字段" class="headerlink" title="HTTP 请求首部字段"></a>HTTP 请求首部字段</h3><h4 id="Origin"><a href="#Origin" class="headerlink" title="Origin"></a><code>Origin</code></h4><p>Origin 首部字段表明预检请求或实际请求的源站。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Origin: &lt;origin&gt;</span><br></pre></td></tr></table></figure>
<p>origin 参数的值为源站 URI。它不包含任何路径信息，只是服务器名称。</p>
<h4 id="Access-Control-Request-Method"><a href="#Access-Control-Request-Method" class="headerlink" title="Access-Control-Request-Method"></a><code>Access-Control-Request-Method</code></h4><p><code>Access-Control-Request-Method</code> 首部字段用于预检请求。其作用是，将实际请求所使用的 HTTP 方法告诉服务器。</p>
<p>Access-Control-Request-Method: <method></method></p>
<h4 id="Access-Control-Request-Headers"><a href="#Access-Control-Request-Headers" class="headerlink" title="Access-Control-Request-Headers"></a><code>Access-Control-Request-Headers</code></h4><p><code>Access-Control-Request-Headers</code> 首部字段用于预检请求。其作用是，将实际请求所携带的首部字段告诉服务器。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Request-Headers: &lt;field-name&gt;[, &lt;field-name&gt;]*</span><br></pre></td></tr></table></figure>
<h2 id="HTTP-Messages"><a href="#HTTP-Messages" class="headerlink" title="HTTP Messages"></a>HTTP Messages</h2><p><a href="http://shawnchenxmu.github.io/2017/07/29/HTTP%20%E6%8A%A5%E6%96%87/" target="_blank" rel="noopener">HTTP报文</a></p>
<details><summary>组成</summary><br><br>HTTP 请求和响应具有相似的结构，由以下部分组成︰<br><br>1. 一行起始行用于描述要执行的请求，或者是对应的状态，成功或失败。这个起始行总是单行的。<br>2. 一个可选的 HTTP 头集合指明请求或描述消息正文。<br>3. 一个空行指示所有关于请求的元数据已经发送完毕。<br>4. 一个可选的包含请求相关数据的正文 (比如 HTML 表单内容), 或者响应相关的文档。 正文的大小有起始行的 HTTP 头来指定。<br><br>起始行和 HTTP 消息中的 HTTP 头统称为请求头，而其有效负载被称为消息正文。<br><br><img src="/2019/08/09/HTTP/7.png" alt><br><br></details>

<h3 id="HTTP-请求"><a href="#HTTP-请求" class="headerlink" title="HTTP 请求"></a>HTTP 请求</h3><h4 id="起始行"><a href="#起始行" class="headerlink" title="起始行"></a>起始行</h4><details><summary>起始行</summary><br><br>起始行 (start-line) 包含三个元素：<br><br>1. 一个 HTTP 方法，一个动词 (像 <code>GET</code>, <code>PUT</code> 或者 <code>POST</code>) 或者一个名词 (像 <code>HEAD</code> 或者 <code>OPTIONS</code>), 描述要执行的动作. 例如, <code>GET</code> 表示要获取资源，<code>POST</code> 表示向服务器推送数据 (创建或修改资源, 或者产生要返回的临时文件)。<br><br>2. 请求目标 (request target)，通常是一个 URL，或者是协议、端口和域名的绝对路径，通常以请求的环境为特征。请求的格式因不同的 HTTP 方法而异。它可以是：<br><br>一个绝对路径，末尾跟上一个 ‘ ? ‘ 和查询字符串。这是最常见的形式，称为『原始形式』(origin form)，被 <code>GET</code>，<code>POST</code>，<code>HEAD</code> 和 <code>OPTIONS</code> 方法所使用。<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP 1.1</span><br><span class="line">GET /background.png HTTP/1.0</span><br><span class="line">HEAD /test.html?query=alibaba HTTP/1.1</span><br><span class="line">OPTIONS /anypage.html HTTP/1.0</span><br></pre></td></tr></table></figure><br><br>一个完整的 URL，被称为『绝对形式』 (absolute form)，主要在使用 <code>GET</code> 方法连接到代理时使用。<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET http://developer.mozilla.org/en-US/docs/Web/HTTP/Messages HTTP/1.1</span><br></pre></td></tr></table></figure><br><br>由域名和可选端口（以’:’为前缀）组成的 URL 的 authority component，称为 authority form。 仅在使用 CONNECT 建立 HTTP 隧道时才使用。<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONNECT developer.mozilla.org:80 HTTP/1.1</span><br></pre></td></tr></table></figure><br><br>星号形式 (asterisk form)，一个简单的星号(<code>*</code>)，配合 <code>OPTIONS</code> 方法使用，代表整个服务器。<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OPTIONS * HTTP/1.1</span><br></pre></td></tr></table></figure><br><br>3. HTTP 版本 (HTTP version)，定义了剩余报文的结构，作为对期望的响应版本的指示符。<br><br></details>

<h4 id="Headers"><a href="#Headers" class="headerlink" title="Headers"></a>Headers</h4><details><summary>分类</summary><br>Headers 可以分为几组：<br><br>1. General headers，例如 Via，适用于整个报文。<br><br>2. Request headers，例如 <code>User-Agent</code>，<code>Accept-Type</code>，通过进一步的定义(例如 <code>Accept-Language</code>)，或者给定上下文(例如 <code>Referer</code>)，或者进行有条件的限制 (例如 <code>If-None</code>) 来修改请求。<br><br>3. Entity headers，例如 <code>Content-Length</code>，适用于请求的 body。显然，如果请求中没有任何 body，则不会发送这样的头文件。<br><br><img src="/2019/08/09/HTTP/8.png" alt><br><br></details>

<h4 id="Body"><a href="#Body" class="headerlink" title="Body"></a>Body</h4><details><summary>分类</summary><br><br>不是所有的请求都有一个 body：例如获取资源的请求，<code>GET</code>，<code>HEAD</code>，<code>DELETE</code> 和 <code>OPTIONS</code>，通常它们不需要 body。 有些请求将数据发送到服务器以便更新数据：常见的的情况是 <code>POST</code> 请求（包含 HTML 表单数据）。<br><br>Body 大致可分为两类：<br><br>1. Single-resource bodies，由一个单文件组成。该类型 body 由两个 header 定义： Content-Type 和 Content-Length。<br><br><br>2. Multiple-resource bodies，由多部分 body 组成，每一部分包含不同的信息位。通常是和  HTML Forms 连系在一起。<br><br></details>

<h3 id="HTTP-响应"><a href="#HTTP-响应" class="headerlink" title="HTTP 响应"></a>HTTP 响应</h3><h4 id="状态行"><a href="#状态行" class="headerlink" title="状态行"></a>状态行</h4><details><summary>组成</summary><br><br>HTTP 响应的起始行被称作 状态行 (status line)，包含以下信息：<br><br>1. 协议版本，通常为 HTTP/1.1。<br>2. 状态码 (status code)，表明请求是成功或失败。常见的状态码是 <code>200</code>，<code>404</code> 或 <code>302</code>。<br>3. 状态文本 (status text)。一个简短的信息，通过状态码的文本描述，帮助人们理解该 HTTP 消息。<br><br>一个典型的状态行看起来像这样：HTTP/1.1 404 Not Found。<br><br></details>

<h4 id="Headers-1"><a href="#Headers-1" class="headerlink" title="Headers"></a>Headers</h4><p><img src="/2019/08/09/HTTP/9.png" alt></p>
<h4 id="Body-1"><a href="#Body-1" class="headerlink" title="Body"></a>Body</h4><details><summary>分类</summary><br><br>不是所有的响应都有 body：具有状态码 (如 <code>201</code> 或 <code>204</code>) 的响应，通常不会有 body。<br><br>Body 大致可分为三类：<br><br>1. Single-resource bodies，由已知长度的单个文件组成。该类型 body 由两个 header 定义：<code>Content-Type</code> 和 <code>Content-Length</code>。<br><br>2. Single-resource bodies，由未知长度的单个文件组成，通过将 <code>Transfer-Encoding</code> 设置为 <code>chunked</code> 来使用 chunks 编码。<br><br>3. Multiple-resource bodies，由多部分 body 组成，每部分包含不同的信息段。但这是比较少见的。<br><br></details>

<h3 id="HTTP-2-帧"><a href="#HTTP-2-帧" class="headerlink" title="HTTP/2 帧"></a>HTTP/2 帧</h3><p>HTTP/1.x 报文有一些性能上的缺点：</p>
<ul>
<li>Header 不像 body，它不会被压缩。</li>
<li>两个报文之间的 header 通常非常相似，但它们仍然在连接中重复传输。</li>
<li>无法复用。当在同一个服务器打开几个连接时：TCP 热连接比冷连接更加有效。</li>
</ul>
<p>HTTP/2 引入了一个额外的步骤：它将 HTTP/1.x 消息分成帧并嵌入到流 (stream) 中。数据帧和报头帧分离，这将允许报头压缩。将多个流组合，这是一个被称为 多路复用 (multiplexing) 的过程，它允许更有效的底层 TCP 连接。</p>
<p><img src="/2019/08/09/HTTP/10.png" alt></p>
<p>HTTP 帧现在对 Web 开发人员是透明的。在 HTTP/2 中，这是一个在  HTTP/1.1 和底层传输协议之间附加的步骤。Web 开发人员不需要在其使用的 API 中做任何更改来利用 HTTP 帧；当浏览器和服务器都可用时，HTTP/2 将被打开并使用。</p>
<h2 id="HTTP-Headers"><a href="#HTTP-Headers" class="headerlink" title="HTTP Headers"></a>HTTP Headers</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers" target="_blank" rel="noopener">HTTP Headers</a></p>
<h3 id="Authentication"><a href="#Authentication" class="headerlink" title="Authentication"></a>Authentication</h3><details><summary>Authentication</summary><br><strong><code>WWW-Authenticate</code></strong><br>Defines the authentication method that should be used to gain access to a resource.<br><br><strong><code>Authorization</code></strong><br>Contains the credentials to authenticate a user agent with a server.<br><br><strong><code>Proxy-Authenticate</code></strong><br>Defines the authentication method that should be used to gain access to a resource behind a Proxy server.<br><br><strong><code>Proxy-Authorization</code></strong><br>Contains the credentials to authenticate a user agent with a proxy server.<br><br></details>

<h3 id="Caching"><a href="#Caching" class="headerlink" title="Caching"></a>Caching</h3><details><summary>Authentication</summary><br><strong><code>Age</code></strong><br>The time in seconds the object has been in a proxy cache.<br><br><strong><code>Cache-Control</code></strong><br>Specifies directives for caching mechanisms in both requests and responses.<br><br><strong><code>Clear-Site-Data</code></strong><br>Clears browsing data (e.g. cookies, storage, cache) associated with the requesting website.<br><br><strong><code>Expires</code></strong><br>The date/time after which the response is considered stale.<br><br><strong><code>Pragma</code></strong><br>Implementation-specific header that may have various effects anywhere along the request-response chain. Used for backwards compatibility with HTTP/1.0 caches where the Cache-Control header is not yet present.<br><br><strong><code>Warning</code></strong><br>A general warning field containing information about possible problems.<br><br></details>

<h3 id="Conditionals"><a href="#Conditionals" class="headerlink" title="Conditionals"></a>Conditionals</h3><details><summary>Conditionals</summary><br><strong><code>Last-Modified</code></strong><br>It is a validator, the last modification date of the resource, used to compare several versions of the same resource. It is less accurate than <code>ETag</code>, but easier to calculate in some environments. Conditional requests using <code>If-Modified-Since</code> and <code>If-Unmodified-Since</code> use this value to change the behavior of the request.<br><br><strong><code>ETag</code></strong><br>It is a validator, a unique string identifying the version of the resource. Conditional requests using <code>If-Match</code> and <code>If-None-Match</code> use this value to change the behavior of the request.<br><br><strong><code>If-Match</code></strong><br>Makes the request conditional and applies the method only if the stored resource matches one of the given <code>ETags</code>.<br><br><strong><code>If-None-Match</code></strong><br>Makes the request conditional and applies the method only if the stored resource doesn’t match any of the given <code>ETags</code>. This is used to update caches (for safe requests), or to prevent to upload a new resource when one is already existing.<br><br><strong><code>If-Modified-Since</code></strong><br>Makes the request conditional and expects the entity to be transmitted only if it has been modified after the given date. This is used to transmit data only when the cache is out of date.<br><br><strong><code>If-Unmodified-Since</code></strong><br>Makes the request conditional and expects the entity to be transmitted only if it has not been modified after the given date. This is used to ensure the coherence of a new fragment of a specific range with previous ones, or to implement an optimistic concurrency control system when modifying existing documents.<br><br><strong><code>Vary</code></strong><br>Determines how to match future request headers to decide whether a cached response can be used rather than requesting a fresh one from the origin server.<br><br></details>

<h3 id="Connection-managementSection"><a href="#Connection-managementSection" class="headerlink" title="Connection managementSection"></a>Connection managementSection</h3><details><summary>Connection managementSection</summary><br><strong><code>Connection</code></strong><br>Controls whether the network connection stays open after the current transaction finishes.<br><br><strong><code>Keep-Alive</code></strong><br>Controls how long a persistent connection should stay open.<br><br></details>

<h3 id="Content-negotiationSection"><a href="#Content-negotiationSection" class="headerlink" title="Content negotiationSection"></a>Content negotiationSection</h3><details><summary>Content negotiationSection</summary><br><strong><code>Accept</code></strong><br>Informs the server about the types of data that can be sent back. It is MIME-type.<br><br><strong><code>Accept-Charset</code></strong><br>Informs the server about which character set the client is able to understand.<br><br><strong><code>Accept-Encoding</code></strong><br>Informs the server about the encoding algorithm, usually a compression algorithm, that can be used on the resource sent back.<br><br><strong><code>Accept-Language</code></strong><br>Informs the server about the language the server is expected to send back. This is a hint and is not necessarily under the full control of the user: the server should always pay attention not to override an explicit user choice (like selecting a language in a drop down list).<br><br></details>

<h3 id="Controls"><a href="#Controls" class="headerlink" title="Controls"></a>Controls</h3><details><summary>Controls</summary><br><strong><code>Expect</code></strong><br>Indicates expectations that need to be fulfilled by the server in order to properly handle the request.<br><br></details>

<h3 id="Cookies"><a href="#Cookies" class="headerlink" title="Cookies"></a>Cookies</h3><details><summary>Cookies</summary><br><strong><code>Cookie</code></strong><br>Contains stored HTTP cookies previously sent by the server with the <code>Set-Cookie</code> header.<br><br><strong><code>Set-Cookie</code></strong><br>Send cookies from the server to the user agent.<br><br></details>

<h3 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h3><details><summary>CORS</summary><br><strong><code>Access-Control-Allow-Origin</code></strong><br>Indicates whether the response can be shared.<br><br><strong><code>Access-Control-Allow-Credentials</code></strong><br>Indicates whether the response to the request can be exposed when the credentials flag is <code>true</code>.<br><br><strong><code>Access-Control-Allow-Headers</code></strong><br>Used in response to a preflight request to indicate which HTTP headers can be used when making the actual request.<br><br><strong><code>Access-Control-Allow-Methods</code></strong><br>Specifies the method or methods allowed when accessing the resource in response to a preflight request.<br><br><strong><code>Access-Control-Expose-Headers</code></strong><br>Indicates which headers can be exposed as part of the response by listing their names.<br><br><strong><code>Access-Control-Max-Age</code></strong><br>Indicates how long the results of a preflight request can be cached.<br><br><strong><code>Access-Control-Request-Headers</code></strong><br>Used when issuing a preflight request to let the server know which HTTP headers will be used when the actual request is made.<br><br><strong><code>Access-Control-Request-Method</code></strong><br>Used when issuing a preflight request to let the server know which HTTP method will be used when the actual request is made.<br><br><strong><code>Origin</code></strong><br>Indicates where a fetch originates from.<br><br><strong><code>Timing-Allow-Origin</code></strong><br>Specifies origins that are allowed to see values of attributes retrieved via features of the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Resource_Timing_API" target="_blank" rel="noopener">Resource Timing API</a>, which would otherwise be reported as zero due to cross-origin restrictions.<br><br></details>

<h3 id="Do-Not-TrackSection"><a href="#Do-Not-TrackSection" class="headerlink" title="Do Not TrackSection"></a>Do Not TrackSection</h3><details><summary>Do Not TrackSection</summary><br><strong><code>DNT</code></strong><br>Used for expressing the user’s tracking preference.<br><br><strong><code>Tk</code></strong><br>Indicates the tracking status that applied to the corresponding request.<br><br></details>

<h3 id="Downloads"><a href="#Downloads" class="headerlink" title="Downloads"></a>Downloads</h3><details><summary>Do Not TrackSection</summary><br><strong><code>Content-Disposition</code></strong><br>Is a response header if the resource transmitted should be displayed inline (default behavior when the header is not present), or it should be handled like a download and the browser should present a ‘Save As’ window.<br><br></details>

<h3 id="Message-body-information"><a href="#Message-body-information" class="headerlink" title="Message body information"></a>Message body information</h3><details><summary>Message body information</summary><br><br><strong><code>Content-Length</code></strong><br>Indicates the size of the entity-body, in decimal number of octets, sent to the recipient.<br><br><strong><code>Content-Type</code></strong><br>Indicates the media type of the resource.<br><br><strong><code>Content-Encoding</code></strong><br>Used to specify the compression algorithm.<br><br><strong><code>Content-Language</code></strong><br>Describes the language(s) intended for the audience, so that it allows a user to differentiate according to the users’ own preferred language.<br><br><strong><code>Content-Location</code></strong><br>Indicates an alternate location for the returned data.<br><br></details>

<h3 id="Proxies"><a href="#Proxies" class="headerlink" title="Proxies"></a>Proxies</h3><details><summary>Proxies</summary><br><br><strong><code>Forwarded</code></strong><br>Contains information from the client-facing side of proxy servers that is altered or lost when a proxy is involved in the path of the request.<br><br><strong><code>Via</code></strong><br>Added by proxies, both forward and reverse proxies, and can appear in the request headers and the response headers.<br><br></details>

<h3 id="Redirects"><a href="#Redirects" class="headerlink" title="Redirects"></a>Redirects</h3><details><summary>Redirects</summary><br><br><strong><code>Location</code></strong><br>Indicates the URL to redirect a page to.<br><br></details>

<h3 id="Request-context"><a href="#Request-context" class="headerlink" title="Request context"></a>Request context</h3><details><summary>Request context</summary><br><br><strong><code>From</code></strong><br>Contains an Internet email address for a human user who controls the requesting user agent.<br><br><strong><code>Host</code></strong><br>Specifies the domain name of the server (for virtual hosting), and (optionally) the TCP port number on which the server is listening.<br><br><strong><code>Referer</code></strong><br>The address of the previous web page from which a link to the currently requested page was followed.<br><br><strong><code>Referrer-Policy</code></strong><br>Governs which referrer information sent in the Referer header should be included with requests made.<br><br><strong><code>User-Agent</code></strong><br>Contains a characteristic string that allows the network protocol peers to identify the application type, operating system, software vendor or software version of the requesting software user agent.<br><br></details>

<h3 id="Response-context"><a href="#Response-context" class="headerlink" title="Response context"></a>Response context</h3><details><summary>Response context</summary><br><br><strong><code>Allow</code></strong><br>Lists the set of HTTP request methods support by a resource.<br><br><strong><code>Server</code></strong><br>Contains information about the software used by the origin server to handle the request.<br><br></details>

<h3 id="Range-requests"><a href="#Range-requests" class="headerlink" title="Range requests"></a>Range requests</h3><details><summary>Range requests</summary><br><br><strong><code>Accept-Ranges</code></strong><br>Indicates if the server supports range requests, and if so in which unit the range can be expressed.<br><br><strong><code>Range</code></strong><br>Indicates the part of a document that the server should return.<br><br><strong><code>If-Range</code></strong><br>Creates a conditional range request that is only fulfilled if the given etag or date matches the remote resource. Used to prevent downloading two ranges from incompatible version of the resource.<br><br><strong><code>Content-Range</code></strong><br>Indicates where in a full body message a partial message belongs.<br><br></details>

<h2 id="HTTP-的重定向"><a href="#HTTP-的重定向" class="headerlink" title="HTTP 的重定向"></a>HTTP 的重定向</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Redirections" target="_blank" rel="noopener">Redirections in HTTP</a></p>
<p>URL 重定向，也称为 URL 转发，是一种当实际资源，如单个页面、表单或者整个 Web 应用被迁移到新的 URL 下的时候，保持（原有）链接可用的技术。HTTP 协议提供了一种特殊形式的响应—— HTTP 重定向（HTTP redirects）来执行此类操作，该操作可以应用于多种多样的目标：网站维护期间的临时跳转，网站架构改变后为了保持外部链接继续可用的永久重定向，上传文件时的表示进度的页面，等等。</p>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>在 HTTP 协议中，重定向操作由服务器通过发送特殊的响应（即 redirects）而触发。HTTP 协议的重定向响应的状态码为 3xx 。浏览器在接收到重定向响应的时候，会采用该响应提供的新的 URL ，并立即进行加载；大多数情况下，除了会有一小部分性能损失之外，重定向操作对于用户来说是不可见的。</p>
<p><img src="/2019/08/09/HTTP/11.png" alt></p>
<p>不同类型的重定向映射可以划分为三个类别：永久重定向、临时重定向和特殊重定向。</p>
<h4 id="永久重定向"><a href="#永久重定向" class="headerlink" title="永久重定向"></a>永久重定向</h4><p>表示原 URL 不应再被使用，而应该优先选用新的 URL。</p>
<p><code>301</code>、<code>308</code></p>
<h4 id="临时重定向"><a href="#临时重定向" class="headerlink" title="临时重定向"></a>临时重定向</h4><p>有时候请求的资源无法从其标准地址访问，但是却可以从另外的地方访问。在创建、更新或者删除资源的时候，临时重定向也可以用于显示临时性的进度页面。</p>
<p><code>302</code>、<code>303</code>、<code>307</code></p>
<h4 id="特殊重定向"><a href="#特殊重定向" class="headerlink" title="特殊重定向"></a>特殊重定向</h4><p><code>304</code>（Not Modified，资源未被修改）会使页面跳转到本地陈旧的缓存版本当中，而 <code>300</code>（Multiple Choice，多项选择） 则是一种手工重定向：以 Web 页面形式呈现在浏览器中的消息主体包含了一个可能的重定向链接的列表，用户可以从中进行选择。</p>
<h3 id="设定重定向映射的其他方法"><a href="#设定重定向映射的其他方法" class="headerlink" title="设定重定向映射的其他方法"></a>设定重定向映射的其他方法</h3><h4 id="HTML-重定向机制"><a href="#HTML-重定向机制" class="headerlink" title="HTML 重定向机制"></a>HTML 重定向机制</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"refresh"</span> <span class="attr">content</span>=<span class="string">"0;URL=http://www.example.com/"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="JavaScript-重定向机制"><a href="#JavaScript-重定向机制" class="headerlink" title="JavaScript 重定向机制"></a>JavaScript 重定向机制</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.location = <span class="string">"http://www.example.com/"</span>;</span><br></pre></td></tr></table></figure>
<h4 id="优先级"><a href="#优先级" class="headerlink" title="优先级"></a>优先级</h4><ol>
<li>HTTP</li>
<li>HTML</li>
<li>JavaScript</li>
</ol>
<h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><p>需要注意应该尽可能地限制其使用数量，因为每一次重定向都会带来性能上的开销。</p>
<h4 id="域名别称"><a href="#域名别称" class="headerlink" title="域名别称"></a>域名别称</h4><h4 id="保持链接有效"><a href="#保持链接有效" class="headerlink" title="保持链接有效"></a>保持链接有效</h4><h4 id="对于不安全请求的临时响应"><a href="#对于不安全请求的临时响应" class="headerlink" title="对于不安全请求的临时响应"></a>对于不安全请求的临时响应</h4><h4 id="对于耗时请求的临时响应"><a href="#对于耗时请求的临时响应" class="headerlink" title="对于耗时请求的临时响应"></a>对于耗时请求的临时响应</h4><h3 id="在通用服务器中配置重定向"><a href="#在通用服务器中配置重定向" class="headerlink" title="在通用服务器中配置重定向"></a>在通用服务器中配置重定向</h3><h4 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h4><p>创建一个服务器模块来进行重定向设置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">	listen 80;</span><br><span class="line">	server_name example.com;</span><br><span class="line">	<span class="built_in">return</span> 301 <span class="variable">$scheme</span>://www.example.com<span class="variable">$request_uri</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用 rewrite 指令来针对一个文件目录或者一部分页面应用重定向设置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rewrite ^/images/(.*)$ http://images.example.com/<span class="variable">$1</span> redirect;</span><br><span class="line">rewrite ^/images/(.*)$ http://images.example.com/<span class="variable">$1</span> permanent;</span><br></pre></td></tr></table></figure>
<h3 id="重定向死锁（循环）"><a href="#重定向死锁（循环）" class="headerlink" title="重定向死锁（循环）"></a>重定向死锁（循环）</h3><h2 id="HTTP-Request-Methods"><a href="#HTTP-Request-Methods" class="headerlink" title="HTTP Request Methods"></a>HTTP Request Methods</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods" target="_blank" rel="noopener">HTTP request methods</a></p>
<h3 id="GET"><a href="#GET" class="headerlink" title="GET"></a><code>GET</code></h3><p>The <code>GET</code> method requests a representation of the specified resource. Requests using <code>GET</code> should only retrieve data.</p>
<h3 id="HEAD"><a href="#HEAD" class="headerlink" title="HEAD"></a><code>HEAD</code></h3><p>The <code>HEAD</code> method asks for a response identical to that of a <code>GET</code> request, but without the response body.</p>
<h3 id="POST"><a href="#POST" class="headerlink" title="POST"></a><code>POST</code></h3><p>The <code>POST</code> method is used to submit an entity to the specified resource, often causing a change in state or side effects on the server.</p>
<h3 id="PUT"><a href="#PUT" class="headerlink" title="PUT"></a><code>PUT</code></h3><p>The <code>PUT</code> method replaces all current representations of the target resource with the request payload.</p>
<h3 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a><code>DELETE</code></h3><p>The <code>DELETE</code> method deletes the specified resource.</p>
<h3 id="CONNECT"><a href="#CONNECT" class="headerlink" title="CONNECT"></a><code>CONNECT</code></h3><p>The <code>CONNECT</code> method establishes a tunnel to the server identified by the target resource.</p>
<h3 id="OPTIONS"><a href="#OPTIONS" class="headerlink" title="OPTIONS"></a><code>OPTIONS</code></h3><p>The <code>OPTIONS</code> method is used to describe the communication options for the target resource.</p>
<h3 id="TRACE"><a href="#TRACE" class="headerlink" title="TRACE"></a><code>TRACE</code></h3><p>The <code>TRACE</code> method performs a message loop-back test along the path to the target resource.</p>
<h3 id="PATCH"><a href="#PATCH" class="headerlink" title="PATCH"></a><code>PATCH</code></h3><p>The <code>PATCH</code> method is used to apply partial modifications to a resource.</p>
<h2 id="HTTP-Status-Response-Codes"><a href="#HTTP-Status-Response-Codes" class="headerlink" title="HTTP Status Response Codes"></a>HTTP Status Response Codes</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" target="_blank" rel="noopener">HTTP response status codes</a></p>
<p><a href="http://shawnchenxmu.github.io/2017/07/29/HTTP%20状态码/" target="_blank" rel="noopener">HTTP 状态码</a></p>
<p>状态码为客户端提供了一种理解事物处理结果的便捷方式。</p>
<p>总的来说，可以将HTTP状态码分为五类：</p>
<p>以<code>1</code>开头的信息性状态码；<br>以<code>2</code>开头的成功状态码；<br>以<code>3</code>开头的重定向状态码；<br>以<code>4</code>开头的客户端错误状态码；<br>以<code>5</code>开头的服务器错误状态码；</p>
<h2 id="CSP-directives"><a href="#CSP-directives" class="headerlink" title="CSP directives"></a>CSP directives</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy" target="_blank" rel="noopener">Content-Security-Policy</a></p>
<p>HTTP 响应头 <code>Content-Security-Policy</code> 允许站点管理者控制用户代理能够为指定的页面加载哪些资源。除了少数例外情况，设置的政策主要涉及指定服务器的源和脚本结束点。这将帮助防止跨站脚本攻击（Cross-Site Script）</p>
<h2 id="A-typical-HTTP-session"><a href="#A-typical-HTTP-session" class="headerlink" title="A typical HTTP session"></a>A typical HTTP session</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Session" target="_blank" rel="noopener">A typical HTTP session</a></p>
<h2 id="Connection-management-in-HTTP-1-x"><a href="#Connection-management-in-HTTP-1-x" class="headerlink" title="Connection management in HTTP/1.x"></a>Connection management in HTTP/1.x</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Connection_management_in_HTTP_1.x" target="_blank" rel="noopener">Connection management in HTTP/1.x</a></p>
<h2 id="HTTP-2"><a href="#HTTP-2" class="headerlink" title="HTTP 2"></a>HTTP 2</h2><p><a href="https://http2.github.io/" target="_blank" rel="noopener">HTTP/2</a></p>
<h3 id="What-is-HTTP-2"><a href="#What-is-HTTP-2" class="headerlink" title="What is HTTP/2?"></a>What is HTTP/2?</h3><p>HTTP/2 is a replacement for how HTTP is expressed “on the wire.” It is not a ground-up rewrite of the protocol; HTTP methods, status codes and semantics are the same, and it should be possible to use the same APIs as HTTP/1.x (possibly with some small additions) to represent the protocol.</p>
<p>The focus of the protocol is <strong>on performance</strong>; specifically, end-user perceived latency, network and server resource usage. One major goal is to allow the use of a single connection from browsers to a Web site.</p>
<h2 id="相关链接-1"><a href="#相关链接-1" class="headerlink" title="相关链接"></a>相关链接</h2><p><a href="https://httpwg.org/specs/" target="_blank" rel="noopener">HTTP Documentation</a><br><a href="https://tools.ietf.org/html/rfc2616#section-1.1" target="_blank" rel="noopener">Hypertext Transfer Protocol – HTTP/1.1</a><br><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP" target="_blank" rel="noopener">MDN HTTP</a></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/HTTP/" rel="tag">#HTTP</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/07/25/Domain-Name-System-DNS/" rel="next" title="Domain Name System(DNS)">
                <i class="fa fa-chevron-left"></i> Domain Name System(DNS)
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/08/12/ES6+/" rel="prev" title="ES6+">
                ES6+ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <!-- 多说评论框 start -->  
        <div class="ds-thread" data-thread-key="<%- page.path %>" data-title="<%- page.title %>" data-url="<%- page.permalink %>"></div>  
<!-- 多说评论框 end --> 
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"shawnchenxmu"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- 多说公共JS代码 end -->


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="shawnchen">
          <p class="site-author-name" itemprop="name">shawnchen</p>
          <p class="site-description motion-element" itemprop="description">一个脱离了高级趣味的人</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">105</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">116</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/shawnchenxmu" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://500px.com/1004740775" target="_blank" title="500px">
                  
                    <i class="fa fa-fw fa-500px"></i>
                  
                  500px
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href target="_blank" title="Weixin">
                  
                    <i class="fa fa-fw fa-weixin"></i>
                  
                  Weixin
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Overview-of-HTTP"><span class="nav-text">Overview of HTTP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-Cache"><span class="nav-text">HTTP Cache</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#缓存控制"><span class="nav-text">缓存控制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Cache-control"><span class="nav-text">Cache-control</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pragma"><span class="nav-text">Pragma</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#新鲜度"><span class="nav-text">新鲜度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#定义最佳-Cache-Control-策略"><span class="nav-text">定义最佳 Cache-Control 策略</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#缓存验证"><span class="nav-text">缓存验证</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#带-Vary-头的响应"><span class="nav-text">带 Vary 头的响应</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-Cookies"><span class="nav-text">HTTP Cookies</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#用途"><span class="nav-text">用途</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建-Cookie"><span class="nav-text">创建 Cookie</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Set-Cookie-响应头部和-Cookie-请求头部"><span class="nav-text">Set-Cookie 响应头部和 Cookie 请求头部</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#会话期-Cookie"><span class="nav-text">会话期 Cookie</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#持久性-Cookie"><span class="nav-text">持久性 Cookie</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Cookie-的-Secure-和-HttpOnly-标记"><span class="nav-text">Cookie 的 Secure 和 HttpOnly 标记</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Cookie-的作用域"><span class="nav-text">Cookie 的作用域</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第三方-Cookie"><span class="nav-text">第三方 Cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#相关链接"><span class="nav-text">相关链接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cross-Origin-Resource-Sharing-CORS"><span class="nav-text">Cross-Origin Resource Sharing (CORS)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么情况下需要-CORS-？"><span class="nav-text">什么情况下需要 CORS ？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基本功能"><span class="nav-text">基本功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#若干访问控制场景"><span class="nav-text">若干访问控制场景</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#简单请求"><span class="nav-text">简单请求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#预检请求"><span class="nav-text">预检请求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#附带身份凭证的请求"><span class="nav-text">附带身份凭证的请求</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#❗️注意：附带身份凭证的请求与通配符"><span class="nav-text">❗️注意：附带身份凭证的请求与通配符</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-响应首部字段"><span class="nav-text">HTTP 响应首部字段</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Access-Control-Allow-Origin"><span class="nav-text">Access-Control-Allow-Origin</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Access-Control-Expose-Headers"><span class="nav-text">Access-Control-Expose-Headers</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Access-Control-Max-Age"><span class="nav-text">Access-Control-Max-Age</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Access-Control-Allow-Credentials"><span class="nav-text">Access-Control-Allow-Credentials</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Access-Control-Allow-Methods"><span class="nav-text">Access-Control-Allow-Methods</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Access-Control-Allow-Headers"><span class="nav-text">Access-Control-Allow-Headers</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-请求首部字段"><span class="nav-text">HTTP 请求首部字段</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Origin"><span class="nav-text">Origin</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Access-Control-Request-Method"><span class="nav-text">Access-Control-Request-Method</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Access-Control-Request-Headers"><span class="nav-text">Access-Control-Request-Headers</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-Messages"><span class="nav-text">HTTP Messages</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-请求"><span class="nav-text">HTTP 请求</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#起始行"><span class="nav-text">起始行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Headers"><span class="nav-text">Headers</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Body"><span class="nav-text">Body</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-响应"><span class="nav-text">HTTP 响应</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#状态行"><span class="nav-text">状态行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Headers-1"><span class="nav-text">Headers</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Body-1"><span class="nav-text">Body</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-2-帧"><span class="nav-text">HTTP/2 帧</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-Headers"><span class="nav-text">HTTP Headers</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Authentication"><span class="nav-text">Authentication</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Caching"><span class="nav-text">Caching</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Conditionals"><span class="nav-text">Conditionals</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Connection-managementSection"><span class="nav-text">Connection managementSection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Content-negotiationSection"><span class="nav-text">Content negotiationSection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Controls"><span class="nav-text">Controls</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cookies"><span class="nav-text">Cookies</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CORS"><span class="nav-text">CORS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Do-Not-TrackSection"><span class="nav-text">Do Not TrackSection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Downloads"><span class="nav-text">Downloads</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Message-body-information"><span class="nav-text">Message body information</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Proxies"><span class="nav-text">Proxies</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Redirects"><span class="nav-text">Redirects</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Request-context"><span class="nav-text">Request context</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Response-context"><span class="nav-text">Response context</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Range-requests"><span class="nav-text">Range requests</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-的重定向"><span class="nav-text">HTTP 的重定向</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#原理"><span class="nav-text">原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#永久重定向"><span class="nav-text">永久重定向</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#临时重定向"><span class="nav-text">临时重定向</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#特殊重定向"><span class="nav-text">特殊重定向</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#设定重定向映射的其他方法"><span class="nav-text">设定重定向映射的其他方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#HTML-重定向机制"><span class="nav-text">HTML 重定向机制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JavaScript-重定向机制"><span class="nav-text">JavaScript 重定向机制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#优先级"><span class="nav-text">优先级</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#应用场景"><span class="nav-text">应用场景</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#域名别称"><span class="nav-text">域名别称</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#保持链接有效"><span class="nav-text">保持链接有效</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#对于不安全请求的临时响应"><span class="nav-text">对于不安全请求的临时响应</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#对于耗时请求的临时响应"><span class="nav-text">对于耗时请求的临时响应</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#在通用服务器中配置重定向"><span class="nav-text">在通用服务器中配置重定向</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Nginx"><span class="nav-text">Nginx</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#重定向死锁（循环）"><span class="nav-text">重定向死锁（循环）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-Request-Methods"><span class="nav-text">HTTP Request Methods</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GET"><span class="nav-text">GET</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HEAD"><span class="nav-text">HEAD</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#POST"><span class="nav-text">POST</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PUT"><span class="nav-text">PUT</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DELETE"><span class="nav-text">DELETE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CONNECT"><span class="nav-text">CONNECT</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OPTIONS"><span class="nav-text">OPTIONS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TRACE"><span class="nav-text">TRACE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PATCH"><span class="nav-text">PATCH</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-Status-Response-Codes"><span class="nav-text">HTTP Status Response Codes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CSP-directives"><span class="nav-text">CSP directives</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#A-typical-HTTP-session"><span class="nav-text">A typical HTTP session</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Connection-management-in-HTTP-1-x"><span class="nav-text">Connection management in HTTP/1.x</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-2"><span class="nav-text">HTTP 2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#What-is-HTTP-2"><span class="nav-text">What is HTTP/2?</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#相关链接-1"><span class="nav-text">相关链接</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">shawnchen</span>
</div>

<div class="powered-by">
  一切都将逝去
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  



  




  
  

  

  

  

  


</body>
</html>
